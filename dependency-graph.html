<!DOCTYPE html>
<html>
<head>
    <title>Dependency Analysis Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1600px; margin: 20px auto; background: rgba(255, 255, 255, 0.98); padding: 30px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); backdrop-filter: blur(10px); }
        h1 { color: #2c3e50; text-align: center; margin-bottom: 10px; font-size: 2.5em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; }
        .subtitle { text-align: center; color: #7f8c8d; margin-bottom: 30px; font-size: 1.1em; }
        .controls { margin-bottom: 25px; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .controls label { margin-right: 25px; font-weight: 500; color: #2c3e50; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; }
        .controls input[type='checkbox'] { width: 18px; height: 18px; cursor: pointer; accent-color: #667eea; }
        .legend { display: flex; gap: 25px; margin-bottom: 25px; flex-wrap: wrap; justify-content: center; padding: 20px; background: #f8f9fa; border-radius: 12px; }
        .legend-item { display: flex; align-items: center; gap: 10px; padding: 8px 15px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .legend-item:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .legend-color { width: 24px; height: 24px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .tooltip { position: absolute; padding: 15px; background: linear-gradient(135deg, rgba(44, 62, 80, 0.95) 0%, rgba(52, 73, 94, 0.95) 100%); color: white; border-radius: 10px; pointer-events: none; font-size: 13px; max-width: 350px; z-index: 1000; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.2); backdrop-filter: blur(10px); line-height: 1.6; }
        .tooltip strong { color: #3498db; font-size: 14px; display: block; margin-bottom: 8px; }
        .bar { transition: all 0.3s ease; cursor: pointer; }
        .bar:hover { opacity: 0.8; }
        .pie-slice { transition: all 0.3s ease; cursor: pointer; stroke: white; stroke-width: 2; }
        .pie-slice:hover { opacity: 0.8; stroke-width: 3; }
        .chart-label { font-size: 12px; font-weight: 600; fill: #2c3e50; }
        .chart-axis { font-size: 11px; fill: #7f8c8d; }
        #dependencies-table tbody tr { border-bottom: 1px solid #e0e0e0; transition: background 0.2s; }
        #dependencies-table tbody tr:hover { background: #f5f7fa; }
        #dependencies-table tbody td { padding: 12px 15px; color: #2c3e50; }
        .type-badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .type-library { background: #3498db; color: white; }
        .type-file { background: #2ecc71; color: white; }
        .type-feign { background: #e74c3c; color: white; }
        .type-config { background: #9b59b6; color: white; }
        .strength-bar { display: inline-block; width: 60px; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; position: relative; }
        .strength-fill { height: 100%; background: linear-gradient(90deg, #e74c3c, #f39c12, #2ecc71); transition: width 0.3s; }
        .details-list { max-width: 400px; font-size: 11px; color: #7f8c8d; max-height: 200px; overflow-y: auto; padding: 5px; background: #f8f9fa; border-radius: 6px; }
        .details-list div { margin: 3px 0; padding: 3px 0; border-bottom: 1px solid #e9ecef; }
        .details-list div:last-child { border-bottom: none; }
        .details-list::-webkit-scrollbar { width: 6px; }
        .details-list::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
        .details-list::-webkit-scrollbar-thumb { background: #888; border-radius: 3px; }
        .details-list::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”— Repository Dependency Analysis</h1>
        <div class="subtitle">Interactive visualization of dependencies between microservices</div>
        <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 30px;">
            <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.5em;">ðŸ“ˆ Summary Statistics</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 14px; color: #7f8c8d; margin-bottom: 5px;">Total Dependencies</div>
                    <div style="font-size: 28px; font-weight: 700; color: #2c3e50;" id="total-links">0</div>
                </div>
                <div style="padding: 15px; background: #3498db; border-radius: 8px;">
                    <div style="font-size: 18px; color: #2c3e50; margin-bottom: 5px;">Library Dependencies</div>
                    <div style="font-size: 28px; font-weight: 700; color: #2c3e50;" id="library-deps">0</div>
                </div>
                <div style="padding: 15px; background: #2ecc71; border-radius: 8px;">
            <div style="font-size: 18px; color: #2c3e50; margin-bottom: 5px;">CommonFile Dependencies</div>
            <div style="font-size: 28px; font-weight: 700; color: #2c3e50;" id="file-deps">0</div>
                </div>
                <div style="padding: 15px; background: #e74c3c; border-radius: 8px;">
                    <div style="font-size: 18px; color: #2c3e50; margin-bottom: 5px;">Feign Client Dependencies</div>
                    <div style="font-size: 28px; font-weight: 700; color: #2c3e50;" id="feign-deps">0</div>
                </div>
                <div style="padding: 15px; background: #9b59b6; border-radius: 8px;">
                    <div style="font-size: 18px; color: #2c3e50; margin-bottom: 5px;">Config Dependencies</div>
                    <div style="font-size: 28px; font-weight: 700; color: #2c3e50;" id="config-deps">0</div>
                </div>
            </div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
            <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 1.3em;">ðŸ“Š Dependency Type Distribution</h3>
                <svg id="pie-chart" width="100%" height="300"></svg>
            </div>
            <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 1.3em;">ðŸ“ˆ Repository Dependency Count</h3>
                <svg id="bar-chart" width="100%" height="300"></svg>
            </div>
        </div>
        <div id="dependencies-table-container" style="margin-top: 30px;">
            <h2 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.8em;">ðŸ“Š Dependencies Table</h2>
            <div style="overflow-x: auto; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                <table id="dependencies-table" style="border-collapse: collapse; background: white;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                            <th style="padding: 15px; text-align: left; font-weight: 600;">Source Repository</th>
                            <th style="padding: 15px; text-align: left; font-weight: 600;">Target Repository</th>
                            <th style="padding: 15px; text-align: center; font-weight: 100;">  </th>
                            <th style="padding: 15px; text-align: left; font-weight: 600;">Type</th>
                            <th style="padding: 15px; text-align: left; font-weight: 600;">Description</th>
                            <th style="padding: 15px; text-align: left; font-weight: 600;">Details</th>
                        </tr>
                    </thead>
                    <tbody id="dependencies-tbody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="tooltip" id="tooltip" style="display: none;"></div>
    <script>
        const data = {
  "nodes": [
    {
      "id": "inventory-service",
      "dependencyCount": 3
    },
    {
      "id": "payment-service",
      "dependencyCount": 4
    },
    {
      "id": "user-service",
      "dependencyCount": 13
    },
    {
      "id": "order-service",
      "dependencyCount": 3
    },
    {
      "id": "notification-service",
      "dependencyCount": 3
    }
  ],
  "links": [
    {
      "source": "user-service",
      "target": "inventory-service",
      "type": "COMMON_LIBRARY",
      "strength": 0,
      "description": "Common libraries: 8",
      "details": [
        "mysql:mysql-connector-java:8.0.33",
        "org.springframework.boot:spring-boot-starter-data-jpa:${spring-boot.version}",
        "org.apache.commons:commons-lang3:3.12.0",
        "org.projectlombok:lombok:1.18.28",
        "com.fasterxml.jackson.core:jackson-databind:2.15.2",
        "junit:junit:4.13.2",
        "org.springframework.boot:spring-boot-starter-web:${spring-boot.version}",
        "org.springframework.cloud:spring-cloud-starter-openfeign:3.1.8"
      ]
    },
    {
      "source": "user-service",
      "target": "payment-service",
      "type": "COMMON_LIBRARY",
      "strength": 0,
      "description": "Common libraries: 8",
      "details": [
        "mysql:mysql-connector-java:8.0.33",
        "org.springframework.boot:spring-boot-starter-data-jpa:${spring-boot.version}",
        "org.apache.commons:commons-lang3:3.12.0",
        "org.projectlombok:lombok:1.18.28",
        "com.fasterxml.jackson.core:jackson-databind:2.15.2",
        "junit:junit:4.13.2",
        "org.springframework.boot:spring-boot-starter-web:${spring-boot.version}",
        "org.springframework.cloud:spring-cloud-starter-openfeign:3.1.8"
      ]
    },
    {
      "source": "user-service",
      "target": "order-service",
      "type": "COMMON_LIBRARY",
      "strength": 0,
      "description": "Common libraries: 8",
      "details": [
        "mysql:mysql-connector-java:8.0.33",
        "org.springframework.boot:spring-boot-starter-data-jpa:${spring-boot.version}",
        "org.apache.commons:commons-lang3:3.12.0",
        "org.projectlombok:lombok:1.18.28",
        "com.fasterxml.jackson.core:jackson-databind:2.15.2",
        "junit:junit:4.13.2",
        "org.springframework.boot:spring-boot-starter-web:${spring-boot.version}",
        "org.springframework.cloud:spring-cloud-starter-openfeign:3.1.8"
      ]
    },
    {
      "source": "user-service",
      "target": "notification-service",
      "type": "COMMON_LIBRARY",
      "strength": 0,
      "description": "Common libraries: 6",
      "details": [
        "org.apache.commons:commons-lang3:3.12.0",
        "org.projectlombok:lombok:1.18.28",
        "com.fasterxml.jackson.core:jackson-databind:2.15.2",
        "junit:junit:4.13.2",
        "org.springframework.boot:spring-boot-starter-web:${spring-boot.version}",
        "org.springframework.cloud:spring-cloud-starter-openfeign:3.1.8"
      ]
    },
    {
      "source": "user-service",
      "target": "inventory-service",
      "type": "COMMON_FILE",
      "strength": 0,
      "description": "Common files/imports detected",
      "details": [
        "Common imports: 9",
        "com.fasterxml.jackson.annotation.JsonProperty",
        "org.springframework.cloud.openfeign.EnableFeignClients",
        "org.springframework.boot.autoconfigure.SpringBootApplication",
        "org.springframework.beans.factory.annotation.Autowired",
        "org.apache.commons.lang3.StringUtils"
      ]
    },
    {
      "source": "user-service",
      "target": "payment-service",
      "type": "COMMON_FILE",
      "strength": 0,
      "description": "Common files/imports detected",
      "details": [
        "Common imports: 12",
        "org.springframework.web.bind.annotation.PostMapping",
        "com.fasterxml.jackson.annotation.JsonProperty",
        "org.springframework.cloud.openfeign.EnableFeignClients",
        "org.springframework.boot.autoconfigure.SpringBootApplication",
        "org.springframework.beans.factory.annotation.Autowired"
      ]
    },
    {
      "source": "user-service",
      "target": "order-service",
      "type": "COMMON_FILE",
      "strength": 0,
      "description": "Common files/imports detected",
      "details": [
        "Common imports: 14",
        "org.springframework.web.bind.annotation.PostMapping",
        "org.springframework.web.bind.annotation.PathVariable",
        "com.fasterxml.jackson.annotation.JsonProperty",
        "org.springframework.cloud.openfeign.EnableFeignClients",
        "org.springframework.boot.autoconfigure.SpringBootApplication"
      ]
    },
    {
      "source": "user-service",
      "target": "notification-service",
      "type": "COMMON_FILE",
      "strength": 0,
      "description": "Common files/imports detected",
      "details": [
        "Common imports: 9",
        "com.fasterxml.jackson.annotation.JsonProperty",
        "org.springframework.cloud.openfeign.EnableFeignClients",
        "org.springframework.boot.autoconfigure.SpringBootApplication",
        "org.springframework.beans.factory.annotation.Autowired",
        "org.apache.commons.lang3.StringUtils"
      ]
    },
    {
      "source": "user-service",
      "target": "payment-service",
      "type": "FEIGN_CLIENT",
      "strength": 0,
      "description": "Common Feign clients detected",
      "details": [
        "Common Feign client names: 1",
        "Client: notification-service",
        "Common service URLs: 1",
        "URL: http://localhost:8083"
      ]
    },
    {
      "source": "user-service",
      "target": "inventory-service",
      "type": "SHARED_CONFIG",
      "strength": 0,
      "description": "Common configuration detected",
      "details": [
        "Common config files: 1",
        "src/main/resources/application.yml",
        "Common config keys: 19",
        "server",
        "show-sql",
        "dialect",
        "level",
        "ddl-auto"
      ]
    },
    {
      "source": "user-service",
      "target": "payment-service",
      "type": "SHARED_CONFIG",
      "strength": 0,
      "description": "Common configuration detected",
      "details": [
        "Common config files: 1",
        "src/main/resources/application.yml",
        "Common config keys: 25",
        "server",
        "show-sql",
        "dialect",
        "hibernate",
        "spring"
      ]
    },
    {
      "source": "user-service",
      "target": "order-service",
      "type": "SHARED_CONFIG",
      "strength": 0,
      "description": "Common configuration detected",
      "details": [
        "Common config files: 1",
        "src/main/resources/application.yml",
        "Common config keys: 25",
        "server",
        "show-sql",
        "dialect",
        "hibernate",
        "spring"
      ]
    },
    {
      "source": "user-service",
      "target": "notification-service",
      "type": "SHARED_CONFIG",
      "strength": 0,
      "description": "Common configuration detected",
      "details": [
        "Common config files: 1",
        "src/main/resources/application.yml",
        "Common config keys: 11",
        "spring",
        "server",
        "password",
        "application",
        "level"
      ]
    }
  ]
};
        
        let allLinks = data.links;
        let filteredLinks = allLinks;
        const tooltip = d3.select("#tooltip");
        
        function updateStats() {
            document.getElementById('total-links').textContent = filteredLinks.length;
            document.getElementById('library-deps').textContent = filteredLinks.filter(function(l) { return l.type === 'COMMON_LIBRARY'; }).length;
            document.getElementById('file-deps').textContent = filteredLinks.filter(function(l) { return l.type === 'COMMON_FILE'; }).length;
            document.getElementById('feign-deps').textContent = filteredLinks.filter(function(l) { return l.type === 'FEIGN_CLIENT'; }).length;
            document.getElementById('config-deps').textContent = filteredLinks.filter(function(l) { return l.type === 'SHARED_CONFIG'; }).length;
        }
        
        function populateTable() {
            const tbody = document.getElementById('dependencies-tbody');
            tbody.innerHTML = '';
            
            const typeClassMap = { 'COMMON_LIBRARY': 'type-library', 'COMMON_FILE': 'type-file', 'FEIGN_CLIENT': 'type-feign', 'SHARED_CONFIG': 'type-config' };
            const typeNameMap = { 'COMMON_LIBRARY': 'Library', 'COMMON_FILE': 'File', 'FEIGN_CLIENT': 'Feign Client', 'SHARED_CONFIG': 'Config' };
            
            allLinks.forEach(function(link) {
                const row = document.createElement('tr');
                const sourceCell = document.createElement('td');
                const sourceId = typeof link.source === 'object' ? link.source.id : link.source;
                const targetId = typeof link.target === 'object' ? link.target.id : link.target;
                sourceCell.innerHTML = '<strong style="color: #2c3e50; font-size: 14px;">' + sourceId + '</strong>';
                const targetCell = document.createElement('td');
                targetCell.innerHTML = '<strong style="color: #2c3e50; font-size: 14px;">' + targetId + '</strong>';
                
                // Add dependency relationship column
                const relationshipCell = document.createElement('td');
                relationshipCell.innerHTML = '<span style="color: #7f8c8d; font-size: 13px;">' + sourceId + '</span> <span style="color: #667eea; font-weight: 600; margin: 0 8px;">â†’</span> <span style="color: #7f8c8d; font-size: 13px;">' + targetId + '</span>';
                const typeCell = document.createElement('td');
                const typeBadge = document.createElement('span');
                typeBadge.className = 'type-badge ' + (typeClassMap[link.type] || '');
                typeBadge.textContent = typeNameMap[link.type] || link.type;
                typeCell.appendChild(typeBadge);
                const descCell = document.createElement('td');
                descCell.textContent = link.description || '-';
                descCell.style.fontSize = '12px';
                const detailsCell = document.createElement('td');
                if (link.details && link.details.length > 0) {
                    const detailsDiv = document.createElement('div');
                    detailsDiv.className = 'details-list';
                    
                    // For file dependencies, extract and highlight file names
                    if (link.type === 'COMMON_FILE') {
                        link.details.forEach(function(detail) {
                            const detailDiv = document.createElement('div');
                            // Check if this is a file path (contains / or \)
                            if (detail.includes('/') || detail.includes('\\')) {
                                detailDiv.innerHTML = '<span style="color: #e74c3c; font-weight: 600;">ðŸ“„</span> <span style="color: #2c3e50;">' + detail + '</span>';
                            } else if (detail.includes('Common file paths:')) {
                                detailDiv.innerHTML = '<strong style="color: #667eea;">' + detail + '</strong>';
                            } else if (detail.includes('Common imports:') || detail.includes('Common packages:')) {
                                detailDiv.innerHTML = '<span style="color: #7f8c8d; font-style: italic;">' + detail + '</span>';
                            } else {
                                detailDiv.innerHTML = '<span style="color: #3498db;">ðŸ“¦</span> <span style="color: #2c3e50;">' + detail + '</span>';
                            }
                            detailsDiv.appendChild(detailDiv);
                        });
                    } else {
                        link.details.forEach(function(detail) {
                            const detailDiv = document.createElement('div');
                            detailDiv.textContent = 'â€¢ ' + detail;
                            detailsDiv.appendChild(detailDiv);
                        });
                    }
                    detailsCell.appendChild(detailsDiv);
                } else { detailsCell.textContent = '-'; detailsCell.style.color = '#bdc3c7'; }
                row.appendChild(sourceCell); row.appendChild(targetCell); row.appendChild(relationshipCell);
                row.appendChild(typeCell); row.appendChild(descCell); row.appendChild(detailsCell);
                tbody.appendChild(row);
            });
        }
        
        // Create Pie Chart
        function createPieChart() {
            const pieSvg = d3.select('#pie-chart');
            pieSvg.selectAll('*').remove();
            const pieWidth = pieSvg.node().getBoundingClientRect().width || 400;
            const pieHeight = 300;
            const radius = Math.min(pieWidth, pieHeight) / 2 - 40;
            const g = pieSvg.attr('width', pieWidth).attr('height', pieHeight)
                .append('g').attr('transform', 'translate(' + (pieWidth / 2) + ',' + (pieHeight / 2) + ')');
            
            const typeCounts = {};
            filteredLinks.forEach(function(l) { typeCounts[l.type] = (typeCounts[l.type] || 0) + 1; });
            const pieData = Object.keys(typeCounts).map(function(key) { return { type: key, value: typeCounts[key] }; });
            
            if (pieData.length === 0) return;
            
            const pie = d3.pie().value(function(d) { return d.value; });
            const arc = d3.arc().innerRadius(0).outerRadius(radius);
            const arcLabel = d3.arc().innerRadius(radius * 0.7).outerRadius(radius * 0.7);
            
            const typeColorMap = { 'COMMON_LIBRARY': '#3498db', 'COMMON_FILE': '#2ecc71', 'FEIGN_CLIENT': '#e74c3c', 'SHARED_CONFIG': '#9b59b6' };
            
            const arcs = g.selectAll('arc').data(pie(pieData)).enter().append('g');
            arcs.append('path').attr('d', arc).attr('fill', function(d) { return typeColorMap[d.data.type] || '#999'; })
                .attr('class', 'pie-slice').on('mouseover', function(event, d) {
                    d3.select(this).attr('opacity', 0.7);
                    tooltip.style('display', 'block').html('<strong>' + d.data.type + '</strong><br/>Count: ' + d.data.value)
                        .style('left', (event.pageX + 10) + 'px').style('top', (event.pageY - 10) + 'px');
                }).on('mouseout', function() { d3.select(this).attr('opacity', 1); tooltip.style('display', 'none'); });
            
            arcs.append('text').attr('transform', function(d) { return 'translate(' + arcLabel.centroid(d) + ')'; })
                .attr('text-anchor', 'middle').attr('class', 'chart-label')
                .text(function(d) { return d.data.value; });
        }
        
        // Create Bar Chart
        function createBarChart() {
            const barSvg = d3.select('#bar-chart');
            barSvg.selectAll('*').remove();
            const barWidth = barSvg.node().getBoundingClientRect().width || 400;
            const barHeight = 300;
            const margin = { top: 20, right: 30, bottom: 60, left: 60 };
            const chartWidth = barWidth - margin.left - margin.right;
            const chartHeight = barHeight - margin.top - margin.bottom;
            
            const g = barSvg.attr('width', barWidth).attr('height', barHeight)
                .append('g').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');
            
            const repoCounts = {};
            filteredLinks.forEach(function(l) {
                const sourceId = typeof l.source === 'object' ? l.source.id : l.source;
                const targetId = typeof l.target === 'object' ? l.target.id : l.target;
                repoCounts[sourceId] = (repoCounts[sourceId] || 0) + 1;
                repoCounts[targetId] = (repoCounts[targetId] || 0) + 1;
            });
            
            const barData = Object.keys(repoCounts).map(function(key) { return { repo: key, count: repoCounts[key] }; })
                .sort(function(a, b) { return b.count - a.count; });
            
            if (barData.length === 0) return;
            
            const xScale = d3.scaleBand().domain(barData.map(function(d) { return d.repo; })).range([0, chartWidth]).padding(0.2);
            const yScale = d3.scaleLinear().domain([0, d3.max(barData, function(d) { return d.count; })]).nice().range([chartHeight, 0]);
            
            g.append('g').attr('transform', 'translate(0,' + chartHeight + ')').call(d3.axisBottom(xScale))
                .selectAll('text').attr('class', 'chart-axis').attr('transform', 'rotate(-45)').style('text-anchor', 'end');
            g.append('g').call(d3.axisLeft(yScale)).selectAll('text').attr('class', 'chart-axis');
            
            const colorScale = d3.scaleSequential(d3.interpolateViridis).domain([0, barData.length]);
            
            g.selectAll('.bar').data(barData).enter().append('rect').attr('class', 'bar')
                .attr('x', function(d) { return xScale(d.repo); }).attr('y', function(d) { return yScale(d.count); })
                .attr('width', xScale.bandwidth()).attr('height', function(d) { return chartHeight - yScale(d.count); })
                .attr('fill', function(d, i) { return colorScale(i); })
                .on('mouseover', function(event, d) {
                    tooltip.style('display', 'block').html('<strong>' + d.repo + '</strong><br/>Dependencies: ' + d.count)
                        .style('left', (event.pageX + 10) + 'px').style('top', (event.pageY - 10) + 'px');
                }).on('mouseout', function() { tooltip.style('display', 'none'); });
        }
        
        updateStats();
        populateTable();
        createPieChart();
        createBarChart();
    </script>
</body>
</html>